@model IEnumerable<MCP_WEB.Models.IsoniteViewModel>
@{
    Layout = null;

}

   

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Print ISONITE</title>
    <link href="~/css/paper.css" rel="stylesheet" type="text/css" />
    <script>
        function printContent(el) {
            var restorepage = document.body.innerHTML;
            var printcontent = document.getElementById(el).innerHTML;
            document.body.innerHTML = printcontent;
            window.print();
            document.body.innerHTML = restorepage;
        }
    </script>
    <style type="text/css">
        /*@@media print {
            * {
                background-color: #1a4567 !important;
                -webkit-print-color-adjust: exact;
            }
        }*/
        /*@@media print {
            * {
                color: white !important;
            }
        }*/



        .stayVisible {
            position: fixed;
            top: 1em;
            left: 1em;
            width: 8.5em;
            right: auto;
            z-index: 3;
        }

        .btnPrint {
            width: 70px;
            height: 30px;
        }

        .boxBarcode {
            border: 1px solid black;
            width: 100%;
            height: 150px;
            text-align: center;
            margin-right: 4px;
        }

        .page {
            position: relative;
            clear: both;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            z-index: 2;
        }

        .subReport {
            position: relative;
            float: left;
            width: 33%;
            height: 100%;
            border: 1px solid black;
        }

        table {
            border-collapse: collapse;
        }




        @@media print {
            /*@@page {
                size: A4 landscape;
                max-height: 100%;
                max-width: 100%
            }*/
            /*body {
                width: 100%;
                height: 100%;
                -webkit-transform: rotate(-90deg) scale(.68,.68);
                -moz-transform: rotate(-90deg) scale(.58,.58)
            }*/
        }

        div.relative1 {
            position: relative;
            width: 1100px;
            height: 80px;
            /*border: 1px solid lightgray;*/
        }

        .absolute1 {
            position: absolute;
            padding-top: 20px;
            top: 0px;
            right: 800px;
            width: 200px;
            height: 80px;
            /*border: 1px solid lightgray;*/
        }

        .absoluteicon {
            position: absolute;
            padding-top: 10px;
            top: 0px;
            right: 800px;
            width: 300px;
            height: 80px;
            /*border: 1px solid lightgray;*/
        }

        .absolute1_1 {
            position: absolute;
            padding-top: 60px;
            padding-right: 15px;
            padding-left: 15px;
            top: 0px;
            right: 820px;
            width: 250px;
            height: 80px;
            text-align: center;
            font-size: 14px;
            border: 1px solid lightgray;
            padding-bottom: 10px;
        }

        .absolute2 {
            position: absolute;
            padding-top: 20px;
            top: 0px;
            right: 580px;
            width: 200px;
            height: 70px;
            font-size: 18px;
            text-align: center;
            /*border: 1px solid lightgray;
            border-right:none;
            border-top:none;
            border-bottom:none;*/
        }

        .absolute2_1 {
            position: absolute;
            padding-top: 60px;
            padding-left: 10px;
            padding-right: 10px;
            top: 0px;
            right: 550px;
            width: 250px;
            height: 80px;
            text-align: center;
            font-size: 14px;
            border: 1px solid lightgray;
            border-left: none;
            padding-bottom: 10px;
        }

        div.absolute3 {
            position: absolute;
            padding-left: 0px;
            padding-right: 15px;
            padding-top: 5px;
            top: 0px;
            right: 55px;
            width: 480px;
            height: 25px;
            font-size: 14px;
            text-align: center;
            border: 1px solid lightgray;
            border-left: none;
        }

        .absolute3_1 {
            position: absolute;
            padding-top: 20px;
            top: 32px;
            right: 400px;
            width: 150px;
            height: 60px;
            text-align: center;
            font-size: 14px;
            border: 1px solid lightgray;
            border-left: none;
            border-top: none;
        }

        .absolute3_2 {
            position: absolute;
            padding-top: 20px;
            top: 32px;
            right: 250px;
            width: 150px;
            height: 60px;
            text-align: center;
            font-size: 14px;
            border: 1px solid lightgray;
            border-left: none;
            border-right: none;
            border-top: none;
        }

        .absolute3_3 {
            position: absolute;
            padding-top: 20px;
            top: 32px;
            left: 850px;
            width: 193px;
            height: 89px;
            text-align: center;
            font-size: 11px;
            border: 1px solid lightgray;
            border-top: none;
            padding-bottom:10px;
        }

        .absolute3_4 {
            position: absolute;
            padding-top: 15px;
            padding-left: 5px;
            top: 112px;
            right: 400px;
            width: 145px;
            height: 23px;
            text-align: left;
            font-size: 11px;
            border: 1px solid lightgray;
            /*border-top: none;*/
            border-left: none;
            /*padding-bottom: 10px;*/
        }

        .absolute3_5 {
            position: absolute;
            padding-top: 15px;
            padding-left: 5px;
            top: 112px;
            right: 250px;
            width: 145px;
            height: 24px;
            text-align: left;
            font-size: 11px;
            border: 1px solid lightgray;
            border-top: none;
            border-left: none;
            border-right: none;
            
        }

        div.relative2 {
            position: relative;
            /*padding-left: 535px;*/
            top: 60px;
            right: 42px;
            width: 1045px;
            height: 570px;
            /*border: 1px solid lightgray;*/
            /*border-left: none;*/
        }

        div.relative3 {
            position: relative;
            padding-left: 0;
            top: 20px;
            width: 296px;
            height: 480px;
            border: 1px solid lightgray;
            border-top: none;
            border-bottom: none;
            border-left: none;
            border-right: none;
        }

        .absoluteblock-1 {
            /*position: absolute;*/
            /*padding-bottom:2px;
            padding-top:2px;*/
            width: 70px;
            height: 36px;
            font-size: 7px;
            border: 1px solid lightgray;
            
        }

        table, th, td {
            border: 0.1px lightgray;
            border-collapse: collapse;
        }

        th, td {
            padding: 0;
        }

        .csspositionjig {
            right: 50px;
            position: relative;
            font-size: 12px;
        }

        .csspositionjig_1 {
            position: absolute;
            top: 0;
            right: 20px;
            width: 60px;
            border: 1px solid lightgray;
        }

        .cssposition1 {
            text-align: center;
            width: 80px;
            right: 900px;
        }

        .cssposition2 {
            text-align: right;
            width: 70px;
            right: 800px;
            border: 1px solid lightgray;
        }

        .tbmodelqty {
            border: 1px solid lightgray;
            height: 25px;
            font-size: 12px;
        }
    </style>

    <style>
.flex-container {
  padding: 0;
  margin: 0;
  list-style: none;  
  -ms-box-orient: horizontal;
  display: -webkit-box;
  display: -moz-box;
  display: -ms-flexbox;
  display: -moz-flex;
  display: -webkit-flex;
  display: flex;
  border: none;
}

.column { 
  -webkit-flex-direction: column; 
  flex-direction: column; 
  float: left;
  border: none;
}
.column li {
  background: deepskyblue;
  border: none;
}

.column-reverse { 
  -webkit-flex-direction: column-reverse; 
  flex-direction: column-reverse; 
  float: left;
  border: none;
}
/*.column-reverse li {
  background: lightgreen;
  border: 1px solid lightgray;
}*/

/*.flex-item {
  background: tomato;
  padding: 0;
  width: 50px;
  height: 50px;
  margin: 0;
  
  line-height: 50px;
  color: white;
  font-weight: bold;
  font-size: 2em;
  text-align: center;
}*/
</style>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
</head>
<body class="A4 landscape">
    &nbsp;&nbsp;&nbsp;

    <div class="stayVisible">
        <button class="btnPrint" onclick="printContent('print-content')">Print</button>
    </div>

    <div id="print-content">
        @{ var cc = 0;
            var rr = 0;
            var setline = "";}
        @for (var x = 0; x < Enumerable.Count(ViewBag.code); x++)
        {
            <section class="sheet padding-10mm">
                <div class="page">
                    @foreach (var item_h in from h in ViewBag.head as IEnumerable<MCP_WEB.Models.IsoniteViewModel>
                                            where h.IsoniteCode == Convert.ToString(ViewBag.code[x])
                                            select new
                                            {
                                                h.namefrom,
                                                h.addrfrom,
                                                h.nameto,
                                                h.addrto,
                                                h.IsoniteCode,
                                                h.addr6,
                                            }
                                )
                    {
                        <div class="relative1">
                            <div class="absoluteicon"><img style="width:80px;" src="~/images/logonittan.png" /></div>
                            <div class="absolute1"><b> ใบสั่งจ้าง ISONITE</b></div>
                            <div class="absolute2"><b>ผู้รับจ้าง</b></div>
                            <div class="absolute1_1">
                                @item_h.namefrom<br />
                                @item_h.addrfrom
                            </div>
                            <div class="absolute2_1">
                                @item_h.nameto<br />
                                @item_h.addrto
                            </div>

                            <div class="absolute3">
                                ได้ตรวจรับสินค้าตามรายการข้างบนนี้ไว้ถูกต้องแล้ว และ รับรองสินค้าอยู่ในสภาพดี
                            </div>
                            <div class="absolute3_1">
                                ผู้ส่งสินค้า..........<br>
                                (ฝ.ผลิต/ฝ.วางแผน)
                            </div>

                            <div class="absolute3_2">
                                ผู้รับสินค้า..........
                            </div>

                            <div class="absolute3_3">
                                ในนามบริษัท นิตตั้น (ประเทศไทย) จำกัด<br>
                                NITTAN (THAILAND) CO.,LTD.<br>
                                <qrcode alt="QR Code" size="70" content=@ViewBag.code[x] />
                            </div>

                            <div class="absolute3_4">
                                ORDER NO.
                            </div>

                            <div class="absolute3_5">
                                TIME.
                            </div>
                        </div>
                        <div class="relative2">
                            <table>
                                <tr>

                                    @foreach (var k in from jig in ViewBag.jigno as IEnumerable<MCP_WEB.Models.IsoniteViewModel>
                                                      where jig.jigIsoniteCode == Convert.ToString(ViewBag.code[x])
                                                      select new
                                                      {
                                                          jig.jigno
                                                      }
                                            )
                                    {
                                        <td>
                                            <div class="relative3" style="left: 40px;">
                                                <div class="csspositionjig" style=" padding-bottom:10px; text-align:center; height:20px; width:264px;">Jig No. <div class="csspositionjig_1" style=" text-align:right">@Convert.ToString(k.jigno)</div></div>

                                                @*<table style="border: 1px solid lightgray;">*@

                                                @{ var gettablejig = Model.FirstOrDefault(s => s.m_JigVM.JigNo == k.jigno);
                                                    if (gettablejig != null)
                                                    {

                                                        cc = gettablejig.m_JigVM.Column;
                                                        rr = gettablejig.m_JigVM.Row;
                                                        @for (var i = 1; i <= cc; i++)
                                                        {
                                                           
                                                           
                                                            <ul class="flex-container column-reverse">
                                                                @for (var j = 1; j <= rr; j++)
                                                                {
                                                                    setline = "";
                                                                     @*@if (i == 1 || i==3) {
                                                                        
                                                                         @if ( j==1) { setline = "border-top:none; "; }
                                                                         
                                                                          @if (j != 9 && j!=1) { setline = " border-top:none; "; }
                                                                    }

                                                                    @if (i == 2 ) {
                                                                        setline = "border-right: none; border-left: none; ";
                                                                         @if ( j==1) { setline = "border-right: none; border-left: none; border-top:none; "; }
                                                                         
                                                                          @if (j != 9 && j!=1) { setline = "border-right: none; border-left: none; border-top:none; "; }
                                                                    }*@

                                                                    
                                                                    <li>
                                                                        <div class="absoluteblock-1" style="text-align:right; padding-top:2px; @setline">

                                                                            @foreach (var item in Model.Where(w => w.Isonite_LineVM.JigNo == k.jigno && w.IsoniteVM.IsoniteCode == item_h.IsoniteCode))
                                                                            {

                                                                                @*<label>row = </label> @j
                                                                                <label>col = </label> @i*@
                                                                                @if (j.ToString() == item.Isonite_LineVM.JigAddress.ToString().Substring(0, 1) && i.ToString() == item.Isonite_LineVM.JigAddress.ToString().Substring(2))
                                                                                {
                                                                                    @if (item.Isonite_LineVM.TransType == "Sent")
                                                                                    {
                                                                                        <b><font style="font-size:8px;">@item.Isonite_LineVM.BarCode</font><br><font style="font-size:12px;">@item.WeeklyPlanVM.Model</font><br><font style="font-size:12px;">@string.Format("{0:N0}", item.Isonite_LineVM.Qty) </font></b>
                                                                                    }
                                                                                    @if (item.Isonite_LineVM.TransType == "Receive")
                                                                                    {
                                                                                        <b><font style="font-size:8px; color:red;">@item.Isonite_LineVM.BarCode</font><br><font style="font-size:12px; color:red;">@item.WeeklyPlanVM.Model</font><br><font style="font-size:12px; color:red;">@string.Format("{0:N0}", item.Isonite_LineVM.Qty) </font></b>
                                                                                    }


                                                                                }

                                                                            }
                                                                        </div>
                                                                    </li>

                                                                }
                                                            </ul>
                                                        }
                                                    }
                                                    else //ถ้า jig ที่ไม่มีอยู่ใน isonite line  ให้ แสดงjigว่างๆไป
                                                    {
                                                        @for (var i = 1; i <= cc; i++)
                                                        {
                                                            <ul class="flex-container column-reverse">
                                                                @for (var j = 1; j <= rr; j++)
                                                                {
                                                                    setline = "";
                                                                    @if (i == 1 || i == 3)
                                                                    {

                                                                        @if (j == 1) { setline = "border-top:none; "; }

                                                                        @if (j != 9 && j != 1) { setline = " border-top:none; "; }
                                                                    }

                                                                    @if (i == 2)
                                                                    {
                                                                        setline = "border-right: none; border-left: none; ";
                                                                        @if (j == 1) { setline = "border-right: none; border-left: none; border-top:none; "; }

                                                                        @if (j != 9 && j != 1) { setline = "border-right: none; border-left: none; border-top:none; "; }
                                                                    }
                                                                    <li>
                                                                        <div class="absoluteblock-1" style="text-align:right; padding-top:2px; @setline ">

                                                                        </div>
                                                                    </li>

                                                                }
                                                            </ul>
                                                        }
                                                    }

                                                }

                                                @*</table>*@

                                            </div>
                                        </td>
                                    }
                                    <td>
                                        <div class="relative3" style="position:absolute; left:917px;">
                                            <table>
                                                <tr>
                                                    <td><div class="cssposition1" style="padding-bottom:10px; text-align:right">เลขที่</div></td>
                                                    <td colspan="2" style="padding-bottom:10px;"><div class="cssposition2" style="text-align:right; ">@item_h.IsoniteCode</div></td>
                                                </tr>

                                                <tr>

                                                    <td colspan="2" style=" padding-left:20px;">
                                                        <table style="width:150px;">
                                                            <tr>
                                                                <td class="tbmodelqty" style="text-align:center;"> Model</td>
                                                                <td class="tbmodelqty" style="text-align:center;"> Qty(Pcs.)</td>
                                                            </tr>
                                                            @{ int sum = 0;}
                                                            @foreach (var item in from q in Model
                                                                                 group q by new
                                                                                 {
                                                                                     q.WeeklyPlanVM.Model,
                                                                                     q.IsoniteVM.IsoniteCode

                                                                                 } into gcs
                                                                                 where gcs.Key.IsoniteCode == Convert.ToString(ViewBag.code[x])
                                                                                 select new
                                                                                 {
                                                                                     model = gcs.Key.Model,
                                                                                     recqty = gcs.Sum(r => r.Isonite_LineVM.Qty)
                                                                                 })
                                                            {
                                                                <tr>
                                                                    <td class="tbmodelqty" style="text-align:center;"> @item.model</td>
                                                                    <td class="tbmodelqty" style="text-align:right; padding-right:2px;"> @string.Format("{0:N0}", item.recqty)</td>
                                                                </tr>

                                                                sum += Convert.ToInt32(item.recqty);

                                                            }
                                                            <tr>
                                                                <td class="tbmodelqty" style="text-align:center;"> <b><u>SUM</u></b></td>
                                                                <td class="tbmodelqty" style="text-align:right; padding-right:2px;"> @string.Format("{0:N0}", sum)</td>
                                                            </tr>
                                                        </table>

                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                    <td colspan="2">

                                        <div class="relative3" style="width:450px;left: 40px; top:50px;">
                                            <table>
                                                <tr>
                                                    <td colspan="5" style=" font-size:14px; padding-left:10px;">
                                                        *โปรดส่งสินค้าตามกำหนดที่แจ้ง ราคาและเงื่อนไขการชำระเงินตามสัญญา
                                                    </td>

                                                </tr>
                                            </table>

                                        </div>

                                    </td>

                                    <td colspan="2">
                                        <div class="relative3" style="width:450px; left: 40px; top:50px;">
                                            <table>
                                                <tr>
                                                    <td colspan="5" style=" font-size:14px; padding-left:10px;">
                                                        ต้นฉบับแผนกบัญชี/สำเนา 1 แผนกวัสดุ/สำเนา 2 แผนกวางแผน
                                                    </td>

                                                </tr>

                                                <tr>
                                                    <td colspan="5" style=" text-align:right; font-size:14px; padding-top:10px; padding-left:200px;">
                                                        @item_h.addr6
                                                    </td>

                                                </tr>
                                            </table>

                                        </div>
                                    </td>
                                </tr>

                            </table>

                        </div>
                    }

                </div>
            </section>
        }
    </div>
    
</body>



</html>

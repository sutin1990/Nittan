<head>
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
</head>
<div id="addscrollpop" class="scrollpop">
    <div class="addcontentpop">
        @model MCP_WEB.Models.m_ProcessMaster
        @using (Html.BeginForm())
        {
            using (Html.DevExtreme().ValidationGroup())
            {
                @Html.AntiForgeryToken()
                <form id="form1" name="form1" autocomplete=off>
                    <div class="form-group" autocomplete=off>

                        <label class="col-lg-3 col-sm-1 control-label" style="padding-right:0; margin-bottom:10px; margin-top:10px;">Process Code : <span style="color:red;">*</span></label>
                        <div class="col-lg-3 " style="padding-left:0; margin-bottom:10px; margin-top:10px;">
                            @(Html.DevExtreme().TextBox().ID("addtxtProcessCode").Name("ProcessCode"))
                        </div>


                        <label class="col-lg-3 col-sm-1 control-label" style="padding-right:0; margin-bottom:10px; margin-top:10px;">Process Name : <span style="color:red;">*</span></label>
                        <div class="col-lg-3" style="padding-left:0; margin-bottom:10px; margin-top:10px;">
                            @(Html.DevExtreme().TextBox().ID("addtxtProcessName").Name("ProcessName"))
                        </div>

                        <label class="col-lg-3 col-sm-1 control-label" style="padding-right:0; margin-bottom:10px; margin-top:10px;">Trans Date : </label>
                        <div class="col-lg-3" style="padding-left:0; margin-bottom:10px; margin-top:10px;">                            
                            @(Html.DevExtreme().TextBox().ID("addtxtTransDate").Name("TransDate").ReadOnly(true)
                            )
                        </div>

                        <label class="col-lg-3 col-sm-1 control-label" style="padding-right:0; margin-bottom:10px; margin-top:10px;">Create Date : </label>
                        <div class="col-lg-3" style="padding-left:0; margin-bottom:10px; margin-top:10px;">                            
                            @(Html.DevExtreme().TextBox().ID("addtxtCreateDate").Name("CreateDate").ReadOnly(true)
                            )
                        </div>


                        <label class="col-lg-3 col-sm-1 control-label" style="padding-right:0; margin-bottom:10px; margin-top:10px;">ModifyBy : </label>
                        <div class="col-lg-3" style="padding-left:0; margin-bottom:10px; margin-top:10px;">
                            @Html.DevExtreme().TextBox().ID("addtxtModifyBy").Name("ModifyBy").ReadOnly(true)
                        </div>

                        

                        <div class="col-sm-offset-2 col-sm-10" style="text-align:right;">                            
                            
                            @(Html.DevExtreme().Button().ID("addbtnSave")
                                                                            .Text("Save")
                                                                            .OnClick("function (e) {if(e.validationGroup.validate().isValid){SaveAdd(e);} }"))

                            @(Html.DevExtreme().Button().Type(ButtonType.Normal).ID("addbtnCancel")
                                                                            .Text("Cancel")
                                                                            .OnClick("function (e) { addcanselButtonClick(); e.validationGroup.reset(); }"))
                        </div>
                    </div>
                </form>
            }
        }
    </div>
</div>

<script>

    function addcanselButtonClick() {
        //arrgetitem = [];
        //e.validationGroup.reset();
        $('#AddPopup').dxPopup('instance').option('visible', false);

    }
    function SaveAdd() {
        var ProcessCode = $("#addtxtProcessCode").dxTextBox("instance").option("value");
        var ProcessName = $("#addtxtProcessName").dxTextBox("instance").option("value");
        var TransDate = $("#addtxtTransDate").dxTextBox("instance").option("value");
        var CreateDate = $("#addtxtCreateDate").dxTextBox("instance").option("value");
        var ModifyBy = $("#addtxtModifyBy").dxTextBox("instance").option("value");

        var jsonObject = {
             "ProcessCode": ProcessCode, "ProcessName": ProcessName, "TransDate": TransDate, "CreateDate": CreateDate, "ModifyBy": ModifyBy 
        };
       
        var msg = "";
        var status = "";
        $.ajax({
            type: 'GET',
            url: '@Url.Action("SaveAdd", "ProcessMasters", new { httproute = true })',
            data: {"values": JSON.stringify(jsonObject) },
            async: false,
            beforeSend: function () {/*loading*/ },
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                //console.log(result);
                if (result == "error") {
                    var customDialog = DevExpress.ui.dialog.custom({
                        title: 'Insert Process Master Error.',
                        message: 'This processCode : ' + ProcessCode + 'have already.',
                        toolbarItems: [
                            { text: "Close", onClick: function () { return "Ok" } },
                            //{ text: "Not Ok", onClick: function () { return "Not Ok" } }
                        ],
                        width: "400px"

                    });

                    customDialog.show().done(function (dialogResult) {
                        $("#addtxtProcessCode").dxTextBox("instance").focus();
                        //addcanselButtonClick();
                    });
                } else {
                    addcanselButtonClick();
                }
                //addcanselButtonClick();
                //msg = result.moveTicket;
                //status = result.SqlStatus;

                //var customDialog = DevExpress.ui.dialog.custom({
                //    title: 'Insert Moveticket Success',
                //    message: 'New Moveticket: ' + msg +'status:'+ status,
                //    toolbarItems: [
                //        { text: "Close", onClick: function () { return "Ok" } },
                //        //{ text: "Not Ok", onClick: function () { return "Not Ok" } }
                //    ],
                //    width: "500px"

                //});

                //customDialog.show().done(function (dialogResult) {
                //    //$("#addtxtModel").dxTextBox("instance").focus();
                //    addcanselButtonClick();
                //});

            }

        });
    }

</script>